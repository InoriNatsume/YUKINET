<!doctype html>
<html lang="ko"><head>
<meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Symbol Wiki: V_t</title>
<link rel="stylesheet" href="../assets/style.css"/>
<script>
window.MathJax={
  tex:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$'],['\\[','\\]']]},
  options:{skipHtmlTags:['script','noscript','style','textarea','pre','code']}
};
</script>
<script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
</head><body><div class="wrap"><article class="paper"><div class="topnav"><a class="btn" href="index.html">기호 위키 인덱스</a><a class="btn" href="../index.html#notation">최상위 문서(기호 탭)</a></div><h1>Symbol: $v_t$</h1><p class='muted'><strong>속도장 (Velocity field)</strong></p><h2>모티베이션 (Motivation)</h2><p>$v_t$는 시간 $t$에서 ‘분포 $\rho_t$가 어느 방향으로 흘러가는지’를 나타내는 속도장(벡터장)이다. 결정론적(OT/연속방정식) 관점에서 샘플링을 볼 때 자연스럽게 등장한다.</p><ol class='list'><li>결정론적 샘플링(특히 probability-flow ODE 관점)에서는 ‘분포가 흐르는 속도’가 핵심이며, 그 속도장이 $v_t$다. ComfyUI의 많은 non-ancestral sampler를 “어떤 속도장을 어떤 수치적분기로 따라가는가”로 해석할 수 있어, solver 비교가 정리된다.</li><li>수치해석적으로는 $x_{k+1}\approx x_k+h\,v(t_k,x_k)$ 같은 형태가 기본이고, Euler/Heun/다단계 방법은 이 속도장을 어떻게 근사하고 어느 점에서 평가하느냐가 차이를 만든다. 즉 sampler의 ‘차수/안정성’은 결국 $v_t$의 적분 근사 품질로 환원된다.</li><li>CFG는 조건부/비조건부 출력을 섞어 벡터장을 바꾼다. 따라서 <code>cfg</code>를 조절하는 것은 사실상 $v_t$를 스케일링/변형하는 것과 같고, 과도한 <code>cfg</code>에서 생기는 과포화/왜곡을 “벡터장 과증폭”으로 해석할 수 있다(필요하면 CFG-rescale 같은 보정이 여기서 등장).</li><li>OT 관점에서는 $v_t$가 질량을 옮기는 ‘수송 정책’이고, Benamou-Brenier의 action $\int\|v_t\|^2\,d\rho_t\,dt$를 최소화하는 흐름이 가장 ‘부드러운 이동’이다. 영상에서 깜빡임을 줄이려면 프레임 간 분포 수송이 매끄러워야 하는데, 이 역시 $v_t$를 부드럽게 만드는 문제로 정리된다.</li><li>SDE/FPE 관점에서는 확산항이 있어 연속방정식에 추가 항이 붙지만, 여전히 drift/score로부터 유도되는 ‘유효한 흐름’(혹은 probability-flow ODE)을 통해 $v_t$를 정의해 볼 수 있다. 그래서 $v_t$는 ODE/SDE/OT를 한데 묶어 주는 공통 언어로 쓸 수 있다.</li></ol><h2>엄밀 정의 (Formal Definitions)</h2><div class='box'><p class='small'><strong>정의 1.</strong></p><div class='formula'>$$ \partial_t\rho_t+\nabla\cdot(\rho_t v_t)=0 $$</div></div><div class='box'><p class='small'><strong>정의 2.</strong></p><div class='formula'>$$ \int_0^1\!\int_{\mathcal{X}}\|v_t(x)\|_2^2\,d\rho_t(x)\,dt $$</div></div><h2>정의 해설 (Commentary)</h2><h3>해설(요약) (Summary)</h3><p>첫 문장은 $v_t$가 ‘분포 $\rho_t$에 대해 제곱적분 가능한 벡터장’이라는 뜻이다. 즉 $\int\|v_t(x)\|^2\,d\rho_t(x)$가 유한하다고 가정한다.</p><p>둘째 문장은 질량 보존의 PDE다. $\rho_t$가 속도장 $v_t$에 의해 이동(수송)할 때 밀도가 만족해야 하는 방정식이 연속방정식이다.</p><p>OT 관점에서는 $v_t$를 선택해서 $\rho_0$에서 $\rho_1$로 질량을 옮기되, $\int\|v_t\|^2\,d\rho_t\,dt$ 비용을 최소화하는 문제가 핵심으로 등장한다.</p><div class='box'><p class='small'><strong>정의 1.</strong></p><div class='formula'>$$ \partial_t\rho_t+\nabla\cdot(\rho_t v_t)=0 $$</div><h3>해설</h3><ol class='list'><li>이 식은 ‘질량 보존’을 의미한다. 어떤 영역 $A$에 들어 있는 확률질량은 경계로 흐르는 유량에 의해만 변한다.</li><li>속도장 $v_t$가 주어지면, 분포 $\rho_t$는 이 PDE를 만족하며 이동한다(결정론적 수송).</li></ol><h3>직관(정의와 연결)</h3><ol class='list'><li>물(밀도)이 바람(속도장)을 따라 흐른다고 생각하면 된다.</li></ol><h3>수치 예시</h3><ol class='list'><li>1차원에서 $v(x)=-x$면 질량이 원점으로 모이는 흐름이다. $x=2$는 왼쪽으로, $x=-2$는 오른쪽으로 움직인다.</li></ol></div><div class='box'><p class='small'><strong>정의 2.</strong></p><div class='formula'>$$ \int_0^1\!\int_{\mathcal{X}}\|v_t(x)\|_2^2\,d\rho_t(x)\,dt $$</div><h3>해설</h3><ol class='list'><li>이 적분은 “분포를 옮기는 데 든 에너지(작용)”로 해석된다. OT의 Benamou-Brenier 정식화에서 이 비용을 최소화하는 $v_t$가 최적수송 경로를 만든다.</li><li>$\rho_t$가 주어지면, $v_t$가 너무 크면 비용이 커진다. 그래서 OT는 ‘가능하면 짧고 부드럽게 옮기기’를 선호한다.</li></ol><h3>직관(정의와 연결)</h3><ol class='list'><li>질량을 빨리/세게 옮기면 에너지가 많이 든다. OT는 그 에너지를 최소화하는 이동을 고른다.</li></ol><h3>수치 예시</h3><ol class='list'><li>아주 단순히 $\mathcal{X}=\mathbb{R}$, $\rho_t$가 특정 점 근처에 몰려 있고 $v_t$가 상수 1이라면 비용은 대략 $1^2$을 시간에 대해 적분한 값($\approx 1$) 수준이 된다(정확한 값은 $\rho_t$에 의존).</li></ol></div><h2>직관(요약) (Intuition)</h2><ol class='list'><li>공간의 각 위치 $x$에 대해 ‘그 자리의 밀도가 어느 쪽으로 움직이는가’를 주는 화살표장이다.</li><li>샘플러를 매우 작은 step으로 보면, 개별 샘플도 대략 $dx_t/dt=v_t(x_t)$를 따른다고 해석할 수 있다(정확한 동일시는 아님).</li><li>ComfyUI의 결정론 sampler를 아주 작은 step-size로 보면, 한 step 업데이트는 $x\mapsto x+\Delta t\,v_t(x)$ 같은 형태(Euler/Heun 등)로 해석할 수 있다. 즉 “sampler 수식”을 “속도장 적분”으로 읽으면 수치해석적 비교(차수/안정성)가 쉬워진다.</li><li>OT(optimal transport) 관점에서는 $v_t$가 질량을 옮기는 수송 정책이며, action $\int\|v_t\|^2\,d\rho_t\,dt$가 작을수록 ‘부드러운 이동’이다. 영상에서 프레임 간 깜빡임을 줄이는 목표는 결국 분포 수송을 부드럽게(작은 action) 만드는 문제로 연결된다.</li></ol><h2>구체 원소 예시(모음) (Concrete Examples)</h2><ol class='list'><li>(1차원) $v_t(x)=-x$라 하자. $x=2.0$에선 속도 $v=-2.0$이므로 왼쪽으로 당겨진다. Euler로 $\Delta t=0.1$이면 $x_{\text{new}}=2.0+0.1\cdot(-2.0)=1.8$.</li><li>(OT 비용 예) 동적 OT에서 action은 $\int_0^1\int_{\mathcal{X}}\|v_t(x)\|_2^2\,d\rho_t(x)\,dt$로 주어진다.</li><li>(2차원 수치 예) $v(x)=(-x_1,-2x_2)$라 하자. $x=(1.0,0.5)$면 $v(x)=(-1.0,-1.0)$이고, Euler $\Delta t=0.2$면 $x_{\text{new}}=(1.0,0.5)+0.2(-1.0,-1.0)=(0.8,0.3)$이다.</li></ol><h2>코드 대응 (Code Mapping)</h2><ol class='list'><li>deterministic sampler의 drift 근사량이 이 속도장에 대응된다.</li></ol><h2>자주 헷갈리는 점 (Pitfalls)</h2><ol class='list'><li>샘플 단위 업데이트와 분포 수준 속도장을 1:1 동일시하면 해석이 과도 단순화된다.</li></ol><h2>관련 기호 (Related Symbols)</h2><div class='topnav'><a class="btn" href="Rho_t.html">$\rho_t$</a><a class="btn" href="Phi_k.html">$\Phi_k$</a></div><div class="topnav"><a class="btn" href="Rho_t.html">이전: $\rho_t$</a></div></article></div></body></html>