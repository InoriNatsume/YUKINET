<!doctype html>
<html lang="ko"><head>
<meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Symbol Wiki: b_theta</title>
<link rel="stylesheet" href="../assets/style.css"/>
<script>
window.MathJax={
  tex:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$'],['\\[','\\]']]},
  options:{skipHtmlTags:['script','noscript','style','textarea','pre','code']}
};
</script>
<script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
</head><body><div class="wrap"><article class="paper"><div class="topnav"><a class="btn" href="index.html">기호 위키 인덱스</a><a class="btn" href="../index.html#notation">최상위 문서(기호 탭)</a></div><h1>Symbol: $b_\theta$</h1><p class='muted'><strong>drift 사상 (Drift map)</strong></p><h2>모티베이션 (Motivation)</h2><p>연속시간 관점에서 샘플링을 ODE/SDE로 보면, $b_\theta$는 상태가 평균적으로 어떻게 변하는지(결정론적 변화율)를 주는 벡터장이다. 수치해석 관점에선 ‘적분해야 하는 미분방정식의 우변’이다.</p><ol class='list'><li>ComfyUI에서 <code>sampler_name</code>을 바꾸는 것은 결국 “어떤 연속 동역학을 어떤 수치적분기로 근사할 것인가”를 바꾸는 것과 가깝다. 이때 연속 동역학의 ‘평균적인 이동 방향’이 바로 drift $b_\theta$이고, Euler/Heun/DPM 계열은 이를 이산 step으로 적분하는 방식으로 해석할 수 있다.</li><li>결정론 sampler(예: Euler, Heun, DPM++(non-ancestral) 계열)는 ‘노이즈를 새로 뽑지 않고’ 하나의 경로를 따라 내려오는 느낌이 강하다. 이런 성질은 $g\equiv 0$인 probability-flow ODE 관점에서 자연스럽고, 그 ODE의 우변이 $b_\theta$다. 즉 재현성(같은 seed면 같은 결과)을 설명하는 핵심 기호가 $b_\theta$다.</li><li>CFG/컨트롤은 “어느 방향으로 움직일지” 자체를 바꾼다. 수식으로는 $b_\theta(x,t,c)$에서 조건 $c$를 바꾸거나, $b$를 조건부/비조건부 출력의 조합으로 바꾸는 것과 같다. 그래서 <code>cfg</code>를 올리면 경로가 더 강하게 조건 쪽으로 휘는 이유를 drift 관점에서 설명할 수 있다.</li><li>SDE/ancestral 계열에서는 한 step이 drift(평균 이동)와 diffusion(무작위 흔들림)의 합으로 이루어진다. 이때 결과의 ‘형태(구성)’는 대체로 drift가, ‘질감/다양성’은 diffusion이 크게 좌우한다. $b_\theta$와 $g$를 분리해 두면 <code>eta/s_noise/s_churn</code> 같은 파라미터가 어느 항을 건드리는지 명확해져 튜닝이 쉬워진다.</li><li>영상 생성에서는 프레임 간 일관성이 중요한데, drift가 만들어 내는 구조적 이동과 diffusion이 만들어 내는 프레임별 랜덤 질감이 충돌하면 깜빡임이 생긴다. 따라서 “구조는 유지하고 질감만 조절” 같은 실무 목표도 결국 $b_\theta$와 $g$의 역할 분리로 정리된다.</li></ol><h2>엄밀 정의 (Formal Definitions)</h2><div class='box'><p class='small'><strong>정의 1.</strong></p><div class='formula'>$$ b_\theta:\mathcal{X}\times[0,1]\times\mathcal{C}\to\mathcal{X} $$</div></div><div class='box'><p class='small'><strong>정의 2.</strong></p><div class='formula'>$$ \dot{x}_t=b_\theta(x_t,t,c) $$</div></div><h2>정의 해설 (Commentary)</h2><h3>해설(요약) (Summary)</h3><p>첫 문장은 $b_\theta$의 타입 선언이다. 시간 변수 $t\in[0,1]$는 ‘연속시간 매개변수’이며, 구현에서는 종종 $\sigma$로 재매개화되어 나타난다(스케줄러가 하는 일).</p><p>둘째 문장은 ‘확률이 없는 경우’(probability-flow ODE 같은 결정론 경로)에서 상태가 어떻게 움직이는지의 정의다. 수치해석에서는 결국 이 ODE를 이산 step으로 적분한다.</p><p>실무에서는 $b_\theta$를 신경망이 직접 주는 경우는 드물고, 보통 $D_\theta$의 출력(예: $\hat{x}_0$)을 적절히 스케일링해 drift 형태로 바꾼다(<code>to_d</code> 같은 변환).</p><div class='box'><p class='small'><strong>정의 1.</strong></p><div class='formula'>$$ b_\theta:\mathcal{X}\times[0,1]\times\mathcal{C}\to\mathcal{X} $$</div><h3>해설</h3><ol class='list'><li>입력 $(x,t,c)$에서 $x$는 상태, $t$는 연속시간, $c$는 조건이다. 출력은 같은 공간 $\mathcal{X}$의 벡터(변화율)다.</li><li>즉 $b_\theta(x,t,c)$는 “그 상태에서의 순간 속도”를 의미한다.</li></ol><h3>직관(정의와 연결)</h3><ol class='list'><li>‘바람(벡터장)’이 불면 점이 이동한다. $b_\theta$는 그 바람이다.</li></ol><h3>수치 예시</h3><ol class='list'><li>$\mathcal{X}=\mathbb{R}^2$에서 $b_\theta(x,t,c)=(-x_1,-x_2)$라면 $x=(1.0,-0.5)$에서 $b_\theta=(-1.0,0.5)$.</li></ol></div><div class='box'><p class='small'><strong>정의 2.</strong></p><div class='formula'>$$ \dot{x}_t=b_\theta(x_t,t,c) $$</div><h3>해설</h3><ol class='list'><li>이 미분방정식은 “아주 작은 시간 $\Delta t$ 동안 $x$가 $b_\theta$ 방향으로 $\Delta t$만큼 움직인다”는 뜻이다.</li><li>Euler 적분은 $x_{k+1}=x_k+\Delta t_k\,b_\theta(x_k,t_k,c)$로 이를 근사한다. Heun은 중간점에서도 $b_\theta$를 한 번 더 평가해 2차 정확도를 얻는다.</li></ol><h3>직관(정의와 연결)</h3><ol class='list'><li>모든 sampler는 결국 이런 ‘연속 흐름’을 이산화한 것이라고 생각하면, 이름이 달라도 공통 구조가 보인다.</li></ol><h3>수치 예시</h3><ol class='list'><li>$b(x)=-x$, $x_0=2.0$, $\Delta t=0.1$이면 $x_1=1.8$ (위와 동일). $\Delta t=0.5$이면 $x_1=1.0$로 더 크게 이동한다.</li></ol></div><h2>직관(요약) (Intuition)</h2><ol class='list'><li>노이즈가 없다고 생각하면 $b_\theta$가 가리키는 방향으로 상태가 흘러간다.</li><li>샘플러는 이 흐름을 이산 step으로 잘라 근사하는 것이라 볼 수 있다.</li><li>ComfyUI의 결정론 sampler(euler/heun/lms/dpmpp_2m 등)는 ‘어떤 ODE를 적분한다’고 볼 수 있고, 그 ODE의 우변(벡터장)이 $b_\theta$다. 즉 sampler 커스터마이징은 사실상 $b_\theta$의 근사 방식(수치적분기)을 바꾸는 일이다.</li><li>코드에서는 보통 $D_\theta$ 출력(예: denoised $\hat{x}_0$)으로부터 $d=(x-\hat{x}_0)/\sigma$ 같은 ‘미분량’을 만들고, 이를 drift 근사로 쓴다. 즉 $b_\theta$는 신경망 출력 그 자체라기보다 “신경망 출력으로부터 구성된 벡터장”인 경우가 많다.</li></ol><h2>구체 원소 예시(모음) (Concrete Examples)</h2><ol class='list'><li>(1차원 예) $b_\theta(x,t,c)=-x$라고 하자. $x=2.0$, $\Delta t=0.1$이면 Euler 한 step은 $x_{\text{new}}=2.0+0.1\cdot(-2.0)=1.8$이다.</li><li>(2차원 예) $b_\theta(x,t,c)=(-x_1,-x_2)$라면 $x=(1.0,-0.5)$에서 $b_\theta(x,\cdot,\cdot)=(-1.0,0.5)$이다.</li><li>(denoised→drift 예) $\sigma=2.0$, $x=(1.0,-0.5)$, $\hat{x}_0=(0.4,-0.3)$라 하자. 그러면 $d=(x-\hat{x}_0)/\sigma=((0.6,-0.2))/2=(0.3,-0.1)$이고, 많은 샘플러는 이 $d$를 ‘$\sigma$-축에서의 변화율’로 사용한다(표기만 다를 뿐 drift 역할).</li><li>(step-size 영향) 같은 $b(x)=-x$에서 $x_0=2.0$라도 $\Delta t=0.05$면 $x_1=1.9$, $\Delta t=0.5$면 $x_1=1.0$으로 이동량이 크게 달라진다. ComfyUI에서 <code>steps</code>/스케줄이 결과를 바꾸는 이유가 여기에 있다.</li></ol><h2>코드 대응 (Code Mapping)</h2><ol class='list'><li>코드에서는 종종 <code>d = to_d(x, sigma, denoised)</code>가 drift 근사량 역할을 한다.</li></ol><h2>자주 헷갈리는 점 (Pitfalls)</h2><ol class='list'><li>모델 출력을 drift로 변환하는 스케일 계수를 놓치면 전혀 다른 동역학이 된다.</li></ol><h2>관련 기호 (Related Symbols)</h2><div class='topnav'><a class="btn" href="D_theta.html">$D_\theta$</a><a class="btn" href="g_func.html">$g$</a><a class="btn" href="Rho_t.html">$\rho_t$</a></div><div class="topnav"><a class="btn" href="D_theta.html">이전: $D_\theta$</a><a class="btn" href="g_func.html">다음: $g$</a></div></article></div></body></html>